<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>3D Zernike Descriptors: Factorial.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<h1>Factorial.h</h1><div class="fragment"><pre>00001 <span class="preprocessor">#ifndef FACTORIAL_H</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define FACTORIAL_H</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#include &lt;vector&gt;</span>
00005 <span class="preprocessor">#include &lt;iostream&gt;</span>
00006 <span class="preprocessor">#include &lt;assert.h&gt;</span>
00007 
00008 <span class="keyword">using</span> std::vector;
00009 
00018 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00019"></a><a class="code" href="classFactorial.html">00019</a> <span class="keyword">class </span><a class="code" href="classFactorial.html">Factorial</a>
00020 {
00021 <span class="keyword">public</span>:
00023     <span class="keyword">static</span> T <a class="code" href="classFactorial.html#e0">Get</a> (<span class="keywordtype">int</span> _i);
00025     <span class="keyword">static</span> T <a class="code" href="classFactorial.html#e0">Get</a> (<span class="keywordtype">int</span> _i, <span class="keywordtype">int</span> _j);
00027     <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classFactorial.html#e2">SetMax</a> (<span class="keywordtype">int</span> _max);
00029     <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classFactorial.html#e3">GetMax</a> ();
00030 
00031 <span class="keyword">private</span>:
00033     <span class="keyword">static</span> <span class="keywordtype">void</span> ComputeFactorials ();
00034 
00035     <span class="keyword">static</span> <span class="keywordtype">int</span> max_;
00036     <span class="keyword">static</span> vector&lt;T&gt;           factorials_;
00037     <span class="keyword">static</span> vector&lt;vector&lt;T&gt; &gt;  subFactorials_;
00038 };
00039 
00040 <span class="comment">// The obligatory initialization of static attributes</span>
00041 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; 
00042 <span class="keywordtype">int</span> <a class="code" href="classFactorial.html">Factorial&lt;T&gt;</a>::max_ = 19;
00043 
00044 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; 
00045 vector&lt;T&gt; <a class="code" href="classFactorial.html">Factorial&lt;T&gt;</a>::factorials_;
00046 
00050 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
00051 <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classFactorial.html">Factorial&lt;T&gt;::ComputeFactorials</a> ()
00052 {
00053     factorials_.resize (max_);
00054 
00055     factorials_[0] = (T)1;
00056 
00057     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;max_; ++i)
00058     {
00059         factorials_[i] = factorials_[i-1] * (T)(i+1);
00060     }
00061 }
00062 
00067 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00068"></a><a class="code" href="classFactorial.html#e0">00068</a> <span class="keyword">inline</span> T <a class="code" href="classFactorial.html#e0">Factorial&lt;T&gt;::Get</a> (<span class="keywordtype">int</span> _i)
00069 {
00070     assert (_i &gt;= 0 &amp;&amp; _i &lt;= max_);
00071 
00072     <span class="keywordflow">if</span> (!factorials_.size ())
00073     {
00074         ComputeFactorials ();
00075     }
00076 
00077     <span class="comment">// 0! = 1</span>
00078     <span class="keywordflow">if</span> (!_i)
00079     {
00080         <span class="keywordflow">return</span> 1;
00081     }
00082     
00083     <span class="keywordflow">return</span> factorials_[_i-1];
00084 }
00085 
00086 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00087"></a><a class="code" href="classFactorial.html#e1">00087</a> <span class="keyword">inline</span> T <a class="code" href="classFactorial.html#e0">Factorial&lt;T&gt;::Get</a> (<span class="keywordtype">int</span> _i, <span class="keywordtype">int</span> _j)
00088 {
00089     T result = (T)1;
00090     <span class="keywordflow">try</span>
00091     {
00092         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=_j; i&gt;=_i; --i)
00093         {
00094             result *= i;
00095         }
00096     }
00097     <span class="keywordflow">catch</span> ( exception &amp;e ) 
00098     {
00099         std::cerr &lt;&lt; <span class="stringliteral">"Caught "</span> &lt;&lt; e.what( ) &lt;&lt; std::endl;
00100         std::cerr &lt;&lt; <span class="stringliteral">"Type "</span> &lt;&lt; <span class="keyword">typeid</span>( e ).name( ) &lt;&lt; std::endl;
00101     };
00102 
00103     <span class="keywordflow">return</span> result;
00104 }
00105 
00106 <span class="comment">/*</span>
00107 <span class="comment"> * Modifies the maximum factorial input parameter. All factorials are recomputed here</span>
00108 <span class="comment"> */</span>
00109 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00110"></a><a class="code" href="classFactorial.html#e2">00110</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classFactorial.html#e2">Factorial&lt;T&gt;::SetMax</a> (<span class="keywordtype">int</span> _max)
00111 {
00112     assert (_max &gt;= (T)0);
00113 
00114     <span class="comment">// In fact, the previously computed factorials could be reused here,</span>
00115     <span class="comment">// however, since this is rarely performed and takes only a couple of</span>
00116     <span class="comment">// multiplications, we don't care.</span>
00117     max_ = _max;
00118     <span class="keywordflow">if</span> (max_ &lt;= _max)
00119     {
00120         ComputeFactorials ();
00121     }
00122 }
00123 
00124 
00125 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00126"></a><a class="code" href="classFactorial.html#e3">00126</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classFactorial.html#e3">Factorial&lt;T&gt;::GetMax</a> ()
00127 {
00128     <span class="keywordflow">return</span> max_;
00129 }
00130 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Dec 5 11:54:44 2003 for 3D Zernike Descriptors by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
